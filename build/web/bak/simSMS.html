<!DOCTYPE html>
<html>
	<head>
		<title>Simulated SMS</title>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="icon" href='images/SoS.png' type='image/x-icon' />
		<link rel="stylesheet" href="style.css">
	</head>
	<body>
		<script src="common.js"></script>
		<div class="head"><p>. . . &nbsp;&ndash; &ndash; &ndash; &nbsp;. . . &nbsp; . . . &nbsp;&ndash; &ndash; &nbsp;. . .</p>
			<p style="font-size: 72px">S<em>o</em>S SMS</p></div>
		<h2>Simulated SMS</h2>
		<p>It looks like you're running this app in a PC browser, which can't send an SMS. If you were running this app on a mobile device
			then it would send an actual SMS instead of displaying this page.  The body of the SMS that would be sent appears below for
			your information.</p>
		<p>But if you believe that the device that you're using can actually send an SMS, please click &nbsp;<a id="sender" href="">Send SMS</a></p>
		<div id="sms" class="config" style="padding: 1ex;"></div>
		<p>If you are evaluating this system to see how it works, you can click on the link in the SMS text above and then see
			what the recipient of the SoS SMS would see.  You could pretend to be that recipient, and take the request for
			assistance through to completion.</p>
		<p>If you want another party to act as the recipient, you can forward the SoS SMS to them as an email.
			Click on &nbsp;<a id="email" href="">Email request</a></p>
		<p><strong>Note:</strong> you will not see this page if you run the app on a phone or tablet, as it would normally run.
			Nor would you be offered email as a way to exchange messages.</p>
		<script>
//			let search = decode(location.search);
//			let text = search.substr(6);  // drop ?body=, replace all \n with <br>
			let text = decode(location.hash.substr(1));  // drop #, replace all \n with <br>
			let pos = text.indexOf("http");
			let url = /*decode*/(text.substr(pos));
			byId("sms").innerHTML = text.substr(0, pos).replaceAll("\n", "<br>") + '<a class="plain" href="' + url + '">' + url + '</a>';
			byId("sender").href = "sms://?" + encode(location.search.substr(1));  // skip encoding the ? at the start of search
			byId("email").href = "mailto://?subject=SoS SMS request" + "&body="
				+ text.substr(0, pos).replaceAll("\n", "%0A") + encode(url);
		</script>
	</body>
</html>
